# Nixpacks configuration for Railway
[phases.setup]
nixPkgs = ["python311", "gcc", "glib", "zlib"]

[phases.install]
cmds = ["pip install -r requirements.txt"]

[phases.build]
cmds = ["mkdir -p uploads models"]

[start]
cmd = "gunicorn -w 1 -b 0.0.0.0:$PORT app:app --timeout 300 --worker-class sync --max-requests 100 --max-requests-jitter 10 --log-level info --preload"

[variables]
PYTHON_VERSION = "3.11"
TF_CPP_MIN_LOG_LEVEL = "2"
TF_ENABLE_ONEDNN_OPTS = "0"
